!function(a){"use strict";var b=function(b){function c(a,b,c){return o(a,"length")?be.call(a,I(b)?b>0?b:0:0,I(c)?c>b?c:b+1:a.length):[a]}function d(a,b){switch(D(a)){case"array":break;case"string":a=a.split(".");break;default:return e(b)}return bb.test(a[0])&&(b=Z,a.shift()),a.length?(!a[0].startsWith("^")||(b?a.shift():a[0]=a[0].substring(1)),b=e(b),a.forEach(function(a){if(!a)return;o(b,a)||(b[a]=t()),b=b[a]}),b):e(b)}function e(a){return N==M?a?a instanceof T?a.exports:a:module.exports:a||b}function f(a){switch(D(a)){case O:return O;case"boolean":return a;case"number":return a!==0&&!isNaN(a);case"string":return!U.some(function(b){return b===a});default:return a===S||a===P?O:R}}function g(a,b,c){return isNaN(b=Number(a))?(c=String(a))in V?V[c]:a:b}function h(a,b,c){c=c===R;for(var d in b)!p(b,d)||c&&p(a,d)||(a[d]=b[d]);return a}function i(a,b,c,d,e){var f=o(a,b);return!c.get&&!c.set||delete c.writable,d===R||!f?Object.defineProperty(a,b,c):e===R&&f&&z().error(new Error("Trying to overwrite existing property: "+b+", in: "+(H(a)?a.n8ivName:a.constructor.n8ivName)+"."),R),Z}function j(a,b,c,d,e){c||(c="cw");for(var f in b)!p(b,f)||i(a,f,k(b[f],c),d,e);return Z}function k(a,b){return h(J(a,R)?a:{value:a},J(b)?b:Y[q(b)]||Y.cew)}function l(a,b){return Object.getOwnPropertyDescriptor(a,b)}function m(a,b){var c;switch(D(a)){case"error":c=a.message;break;case"string":c=String(a),a=new Error(a)}!("error"in console)||console.error(c);if(b===R)throw a;return Z}function n(a){return a!==P&&a!==S&&(typeof a=="number"?!isNaN(a):R)}function o(a,b){return b in Object(a)}function p(a,b){return Q.hasOwnProperty.call(a,b)}function q(a){return String(a).toLowerCase()}function r(a,b){return a?o(a,"id")?a.id:a.id=s(b):s(b)}function s(a){return(a||X)+ ++W}function t(a,b){return(b=Object.create(P))&&arguments.length>=1?h(b,a):b}function u(a){return Object.getPrototypeOf(a)}function v(){}function w(a,b){var c=[a];while(++a<=b)c.push(a);return c}function x(a){return a}function y(a){return Q.toString.call(a)}function z(){return!("trace"in console)||console.trace(),Z}function A(a){return Q.valueOf.call(a)}function B(){var a=this.constructor,b=E(this),c=N!=M?C(b):ba.test(b)?"global":O;return c||(b=="object"&&a.__type__!="function"?a.__type__||q(a.n8ivName)||b:b)}function C(a){return $.test(a)?"htmlcollection":_.test(a)?"htmlelement":ba.test(a)?"global":O}function D(a){return a===P||a===S?O:a.__type__||(u(a)===P?"nullobject":S)}function E(a,b){return(b=y(a))in bf?bf[b]:bf[b]=q(b).match(bc)[1].replace(bd,"$1")}function F(a){return D(a)=="boolean"}function G(a){switch(D(a)){case"array":return!a.length;case"number":return isNaN(a);case"object":return!Object.len(a);case"string":return a==="";default:return!n(a)}}function H(a){return typeof a=="function"}function I(a){return D(a)=="number"&&!isNaN(a)}function J(a,b){var c=D(a);return c=="object"&&E(a)=="object"||b!==R&&c=="nullobject"}function K(a){return D(a)=="string"}function L(a){return typeof a=="undefined"}"use strict",typeof b!="undefined"||(b=a);var M="commonjs",N=typeof module!="undefined"&&"exports"in module?M:typeof navigator!="undefined"?"browser":"other",O=!1,P=null,Q=Object.prototype,R=!0,S,T=N!=M?P:require("module"),U=[0,O,"",NaN,P,S].map(String),V=[O,NaN,P,R,S].reduce(function(a,b){return a[String(b)]=b,a},t()),W=999,X="anon__",Y=function(){var a="configurable enumerable writable".split(" "),b={ce:"ec",cw:"wc",ew:"we",cew:"cwe ecw ewc wce wec".split(" ")},c={c:[R,O,O],ce:[R,R,O],cew:[R,R,R],cw:[R,O,R],e:[O,R,O],ew:[O,R,R],r:[O,O,O],w:[O,O,R]},d=Object.keys(c).reduce(function(d,e){return d[e]=a.reduce(function(a,b,d){return a[b]=c[e][d],a},t()),e in b&&typeof b[e]!="string"?b[e].forEach(function(a){d[a]=d[e]}):d[b[e]]=d[e],d},t());return delete d.undefined,d}(),Z=t(),$=/htmlcollection|nodelist/,_=/^html\w+?element$/,ba=/global|window/i,bb=/^\u005E?n8iv/,bc=/\[[^\s]+\s([^\]]+)\]/,bd=/^[Ww]ebkit|[Mm]oz|O|[Mm]s|[Kk]html(.*)$/,be=Array.prototype.slice,bf={"[object Object]":"object"};return i(Q,"__type__",h({get:B},Y.r)),j(Object,{clone:function(a){return h(t(),a)},each:function(a,b,c){return c||(c=a),Object.keys(a).forEach(function(d,e){b.call(c,a[d],d,a,e)},a),a},key:function(a,b){for(var c in a)if(a[c]===b)return c;return P},len:function(a){return Object.keys(a).length},remove:function(a,b){return(Array.isArray(b)?b:c(arguments,1)).forEach(function(b){delete a[b]}),a},value:function(a,b){if(isNaN(b)&&!!~b.indexOf(".")){var c;b=b.split(".");while(c=b.shift()){a=Object.value(a,c);if(a===S)return a}return a}return G(a)?S:G(a[b])?H(a.get)?a.get(b):H(a.getAttribute)?a.getAttribute(b):S:a[b]},values:function(a){return Object.keys(a).map(function(b){return a[b]})}},"w"),i(Array,"from",k(c,"w")),i(Array.prototype,"find",k(function(a,b){var c=-1,d=this.length>>>0;b||(b=this);while(++c<d)if(!!a.call(b,this[c],c,this))return this[c];return P},"w")),j(Function.prototype,{n8ivName:{get:function(){var a="anonymous",b=["",""],c="__n8ivName__",d=/[\s\(]*function([^\(]+).*/;return function(){if(!this[c]){var f=this.valueOf(),g=f!==this?f.n8ivName!==a?f.n8ivName:P:P,h=this.name||this.displayName||(String(this).match(d)||b)[1].trim();i(this,c,k(g||h||a,"w"))}return this[c]}}()},bind:function(a){var d=c(arguments,1),e=function(){return f.apply(this instanceof e?this:a||b,d.concat(c(arguments)))},f=this;return e.prototype=Object.create(f.prototype),e.mimic(f)},mimic:function(a,b){return Object.defineProperties(this,{displayName:k(b||a.n8ivName,"c"),toString:k(function(){return a.valueOf().toString()},"c"),valueOf:k(function(){return a},"c")})}},"w"),j(String.prototype,{contains:function(a){return!!~this.indexOf(a)},endsWith:function(a){return this.length&&this.lastIndexOf(a)==this.length-a.length},startsWith:function(a){return!this.indexOf(a)}},"w"),typeof global=="undefined"||(b=global),N!=M?i(b,"n8iv",k({value:Z},"w")):module.exports=Z,j(Z,{ENV:N,modes:Y,global:{value:b},bless:d,bool:f,coerce:g,copy:h,def:i,defs:j,describe:k,description:l,error:m,exists:n,got:o,has:p,id:r,isBool:F,isEmpty:G,isFn:H,isNum:I,isObj:J,isStr:K,isUndef:L,nativeType:E,noop:v,obj:t,proto:u,range:w,requite:x,tostr:y,trace:z,type:D,valof:A},"w"),Z}(this);!function(a){function f(a,b,c,d){return d||(d=a),Object.keys(a).reduce(function(b,e,f){return c.call(d,b,a[e],e,a,f)},b)}function g(a){return Object.keys(a).forEach(function(b){delete a[b]},a),a}function h(c,d){switch(a.type(c)){case"array":return Array.isArray(d)?i(c,d):b;case"object":return a.isObj(d)?j(c,d):b;case"date":return+c==+d}return c==d}function i(a,b){return a.length==b.length&&Array.from(a).every(function(a,c){return h(b[c],a)})}function j(c,e){if(Object.len(c)!==Object.len(e)||l(c)!==l(e))return b;for(var f in e)if(a.has(c,f)!==a.has(e,f)||!h(c[f],e[f]))return b;return d}function k(a){return Object.getOwnPropertyNames(a)}function l(a){return k(a).length}function m(a,b,c){return Object.keys(a).reduce(function(c,d,e){return b.call(a,c,a[d],d,a,e)},c)}"use strict";var b=!1,c=null,d=!0,e;a.defs(Object,{aggregate:f,clear:g,equalTo:h,ownKeys:k,ownLen:l,reduce:m},"w"),a.defs(Function.prototype,function(){var b=/^[\s\(]*function[^\(]*\(([^\)]*)\)/,c=/\s*,\s*/;return a.def(Function,"from",a.describe(function(c){return a.isFn(c)?c:function(){return c}},"w")),{params:{get:function(){var a=String(this).match(b)[1].trim().split(c);return a.length==1&&!a[0]?[]:a}},attempt:function(a){var b=Array.from(arguments,1),c=this;return function(){try{return c.apply(a||this,b)}catch(e){return e}}()},bake:function(){var b="baked",c=this;return c[b]||!a.def(c,b,a.describe(function(){return c.apply(this,[this].concat(Array.from(arguments)))}.mimic(c),"w"))||c[b]},defer:a.ENV=="commonjs"?function(a){return process.nextTick(this.bind.apply(this,[a].concat(Array.from(arguments,1))))}:function(){return this.delay.apply(this,[1].concat(Array.from(arguments)))},delay:function(b,c){function f(){return f.stop(),e.apply(c||this,d)}var d=Array.from(arguments,2),e=this;return a.copy(f,{stop:function(){return clearTimeout(this.timeoutId),delete this.timeoutId,e},timeoutId:setTimeout(f,b)})},memoize:function(b){function d(){var a=Array.from(arguments),d=a.toString();return d in b?b[d]:b[d]=c.apply(this,a)}var c=this;return a.isObj(b)||(b=a.obj()),d.unmemoize=function(){return c},d},stop:function(){return this},unmemoize:function(){return this},wrap:function(a){var b=Array.from(arguments,1),c=this;return function(){return a.apply(this,[c.bind(this)].concat(b).concat(Array.from(arguments)))}.mimic(a)}}}(),"w"),a.defs(Array.prototype,function(){function b(a,b){return a(b)?0:1}function e(a,b){return a.test(b)?0:1}function f(a,b){return Object.value(b,a)||1}function g(a){return a?a:c}function h(a){return a[0]}function i(b){return[b,a.isFn(this)?this(b):Object.value(b,this)]}var j=Array.prototype,k={desc:function(a,b){return a[1]==b[1]?0:a[1]<b[1]?1:-1},asc:function(a,b){return a[1]==b[1]?0:a[1]>b[1]?1:-1}};return k[String(d)]=k[1]=k.asc,k[String(!1)]=k[0]=k.desc,a.def(Array,"sortFns",a.describe({value:k},"w")),{aggregate:function(a,b,c){return j.reduce.call(this,function(a,d,e,f){return b.call(c||d,a,d,e,f)},a)},associate:function(b,c,d){return c||(c=a.requite),d||(d=this),j.reduce.call(this,function(a,e,f){return a[b[f]]=c.call(d,e,f,this),a},a.obj())},clear:function(){return this.length=0,this},clone:function(){return j.slice.call(this)},compact:function(b){return j.mapc.call(this,b===d?g:a.requite)},contains:function(a){return!!~j.indexOf.call(this,a)},each:function(a,b){return j.forEach.call(this,a,b||this),this},flatten:function(b){if(a.isNum(b)){if(!(b>0))return this;--b}return j.aggregate.call(this,[],function(a,c,d){return Array.isArray(c)?a.splice.apply(a,[a.length,0].concat(c.flatten(b))):a.push(c),a},this)},grep:function(b,c,d){var e=this;return c||(c=a.requite),d||(d=e),!a.isStr(b)||(b=new RegExp(b.escapeRE(),"g")),j.aggregate.call(e,[],function(a,f,g){return!b.test(f)||a.push(c.call(d,f,g,e)),a})},groupBy:function(c,g,h){g||(g=a.requite);var i=this,k,l,m=a.obj();switch(a.type(c)){case"function":l=b;break;case"regexp":l=e;break;case"number":case"string":l=f,k=j.pluck.call(i,c,d);break;default:a.trace().error(new TypeError("Array.prototype.groupBy can only match based on a Function, RegExp or String."),d)}return(k||[0,1]).forEach(function(a){m[a]=[]}),j.aggregate.call(i,m,function(a,b,d){return a[l(c,b)].push(g.call(this,b,d,i)),a},h||i)},include:function(a){return j.contains.call(this,a)?!1:!this.push(a)||d},invoke:function(a){var b=Array.from(arguments,1);return j.map.call(this,function(c,d){return c[a].apply(c,b)})},invokec:function(b){var d=Array.from(arguments,1);return j.mapc.call(this,function(e,f){return a.isFn(e[b])?e[b].apply(e,d):c})},item:function(a){return this[a<0?this.length+a:a]},last:function(){return this[this.length-1]},mapc:function(b,c){return c||(c=this),j.reduce.call(this,function(d,e,f,g){return!a.exists(e=b.call(c,e,f,g))||d.push(e),d},[])},pluck:function(a,b){return j[b===d?"mapc":"map"].call(this,function(b){return Object.value(b,a)})},remove:function(){var a=Array.from(arguments),b,c=[],d;while(d=a.shift())!~(b=j.indexOf.call(this,d))||c.push(j.splice.call(this,b,1)[0]);return c},sortBy:function(b,c){return j.map.call(this,i,b).sort(a.isFn(c)?c:k[String(c).lc()]||k.asc).map(h)},tuck:function(a,b){var c=Array.isArray(b);return j.each.call(this,function(d,e){d[a]=c?b[e]:b})},uniq:function(){return j.reduce.call(this,function(a,b){return a.contains(b)||a.push(b),a},[])},without:function(){var a=j.clone.call(this);return a.remove.apply(a,arguments),a},zip:function(){var a=Array.from(arguments);return a.unshift(this),j.map.call(this,function(b,c){return a.pluck(c)})}}}(),"w"),a.defs(Number,function(){var b=Math.abs,c=9007199254740992,d=Math.floor;return{isInteger:function(b){return a.isNum(b)&&isFinite(b)&&b>-c&&b<c&&d(b)===b},toInteger:function(a){return a=+a,isNaN(a)?0:a===0||!isFinite(a)?a:(a<0?-1:1)*b(d(a))}}}(),"cw"),a.defs(Number.prototype,{pad:function(a,b){var c=this.toString(b||10);return"0".times(a-c.length)+c},times:function(b,c){return a.range(0,this).forEach(b,c||a.global),this},toHex:function(){return this.pad(2,16)}},"w"),a.defs(String.prototype,function(){function m(a,b){return b+b.lc()}function n(a){a=a.trim();var b=a.charAt(0),c=a.charAt(1),d=b.lc()==b&&c!=" "&&c.uc()==c?2:1,e=a.substring(d).replace(h,m).split(l);return e[0]=a.substring(0,d)+e[0],e}var b=a.obj(),e=a.obj(),f=/([-\*\+\?\.\|\^\$\/\\\(\)[\]\{\}])/g,g="\\$1",h=/([A-Z])/g,i=/\$?\{([^\}]+)\}/g,j=/#?(\w{1,6})/,k=/(\d{1,3})/g,l=/[\sA-Z_-]+/g;return{blank:function(){return!!this.trim().empty()},capitalize:function(){return this.charAt(0).uc()+this.substring(1).lc()},cc:function(){return this.toCamelCase()},clean:function(a){return a||(a=" "),a=b[a]||(b[a]={re:new RegExp("("+a+"){1,}","g"),fill:a}),this.split(a.re).filter(function(b){return!b.blank()&&b!=a.fill}).join(a.fill)},empty:function(){return String(this)===""},format:function(){return this.gsub.call(this,Array.from(arguments))},gsub:function(a,b){return this.replace(b||i,function(b,c){return a[c]||""})},hyphenate:function(){return n(this).join("-").lc()},includes:function(a){return this.lc().contains(String(a).lc())},lc:function(){return this.toLowerCase()},parts:function(a){var b=Array.from(this.match(a));switch(b.length){case 1:if(b[0]===c||b[0]===this)return[];default:return b[0]!==this||b.shift(),b}},qw:function(){return this.split(" ")},regexpEsc:function(){return this.replace(f,g)},sliceEvery:function(a){return a=parseInt(a,10),isNaN(a)||this.length<a||a==0?[String(this)]:this.match(e[a]||(e[a]=new RegExp("(.{1,"+a+"})","g")))},times:function(a){return(new Array(Number.toInteger(a)+1)).join(this)},toCamelCase:function(){var a=n(this),b=[a.shift()];return a.reduce(function(a,b){return a.push(b.capitalize()),a},b).join("")},toHex:function(){function a(a){return parseInt(a,10).pad(2,16)}return function(){var b=this.match(k);return"#"+(b.length==1?a(b[0]).times(3):b.map(a).join(""))}}(),toJSON:function(){return JSON.parse(this)},toRGB:function(a){var b=this.match(j)[1],c=b.length,e;switch(c){case 6:break;case 3:b=this.times(2);break;case 2:b=this.times(3);break;default:b=c>6?b.substring(0,6):c==4?b+"00":b+"0"}return e=b.sliceEvery(2).map(function(a){return parseInt(a,16)}),a===d?e:"rgb("+e.join(", ")+")"},truncate:function(b,c){return b||(b=50),a.isStr(c)||(c="..."),this.length<b?String(this):this.substring(0,b).trimRight()+c},uc:function(){return this.toUpperCase()},underscore:function(){return n(this).join("_").lc()}}}(),"w"),a.ENV!="commonjs"||module.exports===a||(module.exports=a)}(typeof b!="undefined"?b:typeof require!="undefined"?require("./n8iv._"):null),!function(a){"use strict";var b=!1,c=null,d=!0,e;!function(){function f(b,c){!c&&a.isObj(b)&&(c=b,b="");var e,f,l,n,o=a.obj(),p=c.extend||Object,q=c.module,s=c.mixin||t,u=c.singleton,y=k(c.type||b);return!a.isStr(p)||(p=w[p]||x[p]),n=c.constructor!==Object?c.constructor:p,b&&(l=b.split("."),f=l.pop(),l=a.bless(l,q)),a.def(o,"parent",a.describe(a.noop,"cw"),d),a.def(o,"constructor",a.describe(i(n,p,f,o),"w"),d),e=o.constructor,a.def(e,"__type__",a.describe("class","w"),d),a.def(o,"__type__",a.describe(y,"w"),d),Object.remove(c,r),e.prototype=g(o,a.copy(c,s)),a.def(e,"create",a.describe(h(j(e,p)),"w"),d),b=b.replace(v,""),u?(a.def(e,"singleton",a.describe({value:u===d?new e:e.create.apply(e,[].concat(u))},"w")),m(e,b,y),e=e.singleton):b&&m(e,b,y),!f||!l||a.def(l,f,a.describe({value:e},"w")),e}function g(b,c){return Object.each(c,function(c,e){switch(a.type(c)){case"object":a.def(b,e,c,d);break;default:b[e]=c}}),b}function h(a){return function(){return n(a)||a.apply(Object.create(a.prototype),arguments)}}function i(a,b,d,f){var g=p(a,b,d),h=function(){var a=this===e?c:this,b=a?a.constructor:c;return n(b)||g.apply(l(a,h)?a:Object.create(f),arguments)};return h.mimic(a,d)}function j(b,c){if(!("__super"in b.prototype)){var e=b.prototype,f=c.prototype;Object.keys(f).forEach(function(b){if(b in y)return;switch(a.type(f[b])){case"function":e[b]=a.isFn(e[b])?p(e[b],f[b],b):p(f[b],a.noop,b);break;default:b in e||a.def(e,b,a.description(f,b),d)}}),Object.keys(e).forEach(function(b){!a.isFn(e[b])||b in f&&e[b].valueOf()===f[b].valueOf()||(e[b]=p(e[b],a.noop,b))}),f=a.describe({value:Object.create(c.prototype)},"w"),a.def(b,"__super",f),a.def(b.prototype,"__super",f)}return b}function k(a){return a.replace(v,"").replace(u,"_").toLowerCase()}function l(a,c){if(a&&c){if(a instanceof c)return d;if(!(a=a.constructor))return b;do if(a===c)return d;while(a.__super&&(a=a.__super.constructor))}return b}function m(b,c,e){var f=c+q,g=[];!c||!(c in w)||g.push(f+"Class"),!e||!(e in x)||g.push(f+"Type"),g.length&&(a.trace(),g.forEach(a.error),a.error(new Error("n8iv.Class overwrite error."),d)),w[c]=x[e]=b}function n(a){return a?a.singleton||c:c}function o(a){var b=a.constructor,d;for(d in w)if(w[d]===b)return d;return c}function p(c,f,g){return function(){var g,h=a.description(this,"parent")||s;return h.writable=d,a.def(this,"parent",f?a.describe(f,"cw"):s,d),g=c.apply(this,arguments),a.def(this,"parent",h,d),this.chain!==b&&g===e?this:g}.mimic(c,g)}var q=" already exists. Cannot override existing ",r="constructor extend mixin module singleton type".split(" "),s=a.describe(a.noop,"cw"),t=a.obj(),u=/\./g,v=/^\u005E/,w=a.obj(),x=a.obj(),y=a.obj();y.constructor=y.parent=y.__super=y.__type__=d,a.def(f,"is",a.describe(l,"w")).def(f,"type",a.describe(o,"w")).def(a,"Class",a.describe(f,"w")).def(a,"create",a.describe(function(b){var c=x[b]||x["n8iv_"+b]||w[b],e=Array.from(arguments,1);return c||a.trace().error(new Error(b+" does not match any registered n8iv.Classes."),d),c.create.apply(a.global,e)},"w"))}(),a.Class("n8iv.Callback",function(){function e(){return h in this?this:(this[h]=setTimeout(f.bind(this),this.buffer),this.exec.apply(this,arguments))}function f(){clearTimeout(this[h]),delete this[h]}function g(){return this.fire.apply(this,arguments)}a.def(Function.prototype,"callback",a.describe(function(b){return(new a.Callback(this,b)).fire.mimic(this)},"w"));var h="bufferId",i="handleEvent",j="timeoutId";return{constructor:function(d,f){a.copy(this,f||a.obj());var g=a.describe(c,"w"),h=(a.isNum(this.buffer)?e:this.exec).bind(this);g.value=d,a.def(this,"fn",g),g.value=this,a.def(h,"cb",g),g.value=h,a.def(this,"fire",g),this.args||(this.args=[]),this.ctx||(this.ctx=this),a.isNum(this.delay)||(this.delay=c),a.isNum(this.times)&&this.times>0||(this.times=0),this.enable()},chain:d,buffer:c,count:0,delay:c,times:0,disable:function(){this.disabled=d,this[i]=a.noop},enable:function(){this.disabled=b,this[i]=g},exec:function(){if(this.disabled)return;this.times===0||this.times>++this.count||this.disable();var b=Array.from(arguments),d=this,e=d.ctx,f=d.delay,g=a.type(b[0]),h;return g&&(g.endsWith("event")||g=="n8iv_observer")?b.splice.apply(b,[1,0].concat(d.args)):b.unshift.apply(b,d.args),f===c?h=d.fn.apply(e,b):this[j]=setTimeout(function(){d.fn.apply(e,b)},f),h},reset:function(){this.count=0,f.call(this.enable())},stop:function(){!(j in this)||clearTimeout(this[j]),delete this[j]}}}()),a.Class("n8iv.Hash",function(){var d="__hashid__",e=[];return{constructor:function(c){a.def(this,d,a.describe(e.push(a.obj())-1,"w")),!a.isObj(c)||this.set(c)},keys:{get:function(){return Object.keys(e[this[d]])}},length:{get:function(){return this.keys.length}},values:{get:function(){return Object.values(e[this[d]])}},aggregate:function(a,b,c){var f=this,g=e[this[d]];return c||(c=f),Object.keys(g).reduce(function(a,d,e){return b.call(c,a,g[d],d,f,e)},a)},clear:function(){e[this[d]]=a.obj()},clone:function(){return new a.Hash(Object.clone(e[this[d]]))},each:function(a,b){var c=this,f=e[this[d]];return b||(b=c),Object.keys(f).forEach(function(d,e){a.call(b,f[d],d,c,e)},c),c},get:function(b){return a.has(e[this[d]],b)?e[this[d]][b]:c},has:function(b){return a.has(e[this[d]],b)},key:function(a){return Object.key(e[this[d]],a)},reduce:function(a,b){var c=this,f=e[this[d]];return Object.keys(f).reduce(function(b,d,e){return a.call(c,b,f[d],d,c,e)},b)},remove:function(c){return a.has(e[this[d]],c)?delete e[this[d]][c]:b},set:function(b,c){switch(a.type(b)){case"object":case"nullobject":Object.keys(b).forEach(function(a){this.set(a,b[a])},this);break;default:e[this[d]][b]=c}},stringify:function(){return JSON.stringify(e[this[d]])},toString:function(){return a.tostr(e[this[d]])},valueOf:function(){return Object.clone(e[this[d]])}}}()),a.Class("n8iv.Observer",function(){function e(b){b=Object.clone(b);var c=b[o],d,e,f,g=b[s],h;Object.remove(b,o,s);for(d in b){e=b[d],f=a.isUndef(e[s])?g:e[s],h=a.isUndef(e[o])?c:e[o];switch(a.type(e)){case"function":this.on(d,e,c,g);break;case"object":case"nullobject":switch(a.type(e[q])){case"function":case"object":case"nullobject":this.on(d,e[q],h,f);break;case"array":e[q].forEach(function(a){this.on(d,a,h,f)},this)}break;case"array":e.forEach(function(a){this.on(d,a,c,g)},this)}}return this}function f(c){var e=this.args.concat(c[s].args),f=c[o]||this[o],g=c.fire||c[q];return a.isFn(g)?(Object.key(this[o],c[q])?e[0]!==this[o]||e.shift():e[0]!==this[o]&&e.unshift(this[o]),g.apply(f,e)!==b):d}function g(a,b,c){return function(){var e=Array.from(arguments);return e[0]!==a||e.shift(),e.unshift(c,b),m.apply(b,e)}}function h(a,b){var c=this;return b.fire=function(){c.un(a,b[q],b[o]);if(b.fired)return;return b.fired=d,b[q].apply(b[o]||c,arguments)}}function i(a){return function(){return a.handleEvent.apply(a,arguments)}.mimic(a.fire)}function j(b,e,f){b=b.toLowerCase();var g=this[r].get(b),h,i;if(!g)return;switch(a.type(e)){case"n8iv_callback":i={ctx:e,isCB:d};break;default:i={ctx:f||this,fn:e}}i.event=b,i=g.find(k,i),i!==c&&(h=g.indexOf(i),h<0||g.splice(h,1))}function k(a){return(this.isCB===d?a[q].valueOf()===this[o].fire:a[q]===this[q])&&a[o]===this[o]&&a.event===this.event}function l(b,c,d,f){var g,j=this[r],k,l;if(a.isObj(b))return e.call(this,b);switch(k=a.nativeType(c)){case"array":return g=a.obj(),g[b]={fn:c,options:f,ctx:d},e.call(this,g);case"object":case"nullobject":case"n8iv_callback":"handleEvent"in c&&(!a.isObj(d)||!a.isUndef(f)||(f=d),d=c,c=i(c));break;case"string":!d||(c=d[c])}b=b.toLowerCase(),(l=j.get(b))||j.set(b,l=[]);switch(a.type(f)){case"boolean":f={single:!!f};break;case"number":f={delay:f};break;case"object":case"nullobject":f=Object.clone(f);break;default:f=a.obj()}Array.isArray(f.args)||(f.args=[]),g={ctx:d||this,event:b,fn:c,id:++u,options:f},g.fire=(f.single?h.call(this,b,g):g[q]).callback({args:f.args,buffer:f.buffer,ctx:g[o],delay:f.delay}),l.push(g)}function m(){return this.broadcast.apply(this,arguments)}var n="broadcasting",o="ctx",p="destroyed",q="fn",r="listeners",s="options",t="observer_suspended",u=0;return{constructor:function(d){this[n]=b,this[p]=b,this[t]=b,this[r]=a.Hash.create(),!a.isObj(d)||this.on(d),!a.isObj(this.observers)||this.on(this.observers),delete this.observers},broadcast:function(a){if(this[p]||this[t]||!this[r].length||!a||!this[r].has(a=a.toLowerCase()))return;var c=Array.from(arguments,1),d=this[r].get(a).slice();if(!d.length)return;this[n]=a,d.every(f,{args:c,ctx:this}),this[n]=b},buffer:function(b,c,d,e,f){a.isObj(f)||(f=a.obj()),f.buffer=Number.toInteger(b),this.on(c,d,e,f)},delay:function(b,c,d,e,f){a.isObj(f)||(f=a.obj()),f.delay=Number.toInteger(b),this.on(c,d,e,f)},destroy:function(){return this[p]?d:this.broadcast("before:destroy")===b?b:(this[p]=d,this._destroy(),this.broadcast("destroy"),this[t]=d,delete this[r],d)},ignore:j,observe:l,on:l,once:function(b,c,e,f){a.isObj(f)||(f=a.obj()),f.single=d,this.on(b,c,e,f)},purgeObservers:function(a){var b=this[r];if(!a){b.clear();return}a=a.toLowerCase(),!b.has(a)||b.set(a,[])},relayEvents:function(a){var b=Array.from(arguments,1),c;while(c=b.shift())this.on(c,g(this,a,c),a)},resumeEvents:function(){!this[t]||(this[t]=b,this.broadcast("observer:resumed"))},suspendEvents:function(){this[t]||(this[t]=d,this.broadcast("observer:suspended"))},un:j,_destroy:a.noop}}()),a.ENV!="commonjs"||module.exports===a||(module.exports=a)}(typeof b!="undefined"?b:typeof require!="undefined"?require("./n8iv._"):null),b.ENV!="commonjs"||module.exports===b||(module.exports=b)}(this)